$(function(){function v(e,t,n,r){i.moveTo(e,t);i.lineTo(n,r);i.strokeStyle=color;i.stroke()}if(!("getContext"in document.createElement("canvas"))){alert("Sorry, it looks like your browser does not support canvas!");return!1}var e="http://192.168.111.149:1337",t=$(document),n=$(window),r=$("#paper"),i=r[0].getContext("2d"),s=$("#instructions");window.color="#000000";var o,u=Math.round($.now()*Math.random()),a=!1,f,l={},c={},h=io.connect(e);h.on("new_word",function(e){var t=60;$(".word-hint").show();$(".word-hint h1").text(e);$(".timer").text(t);$(".game-on").hide();var n=setInterval(function(){t--;$(".timer").text(t);if(t==0){$(".word-hint").hide();i.clearRect(0,0,r.width(),r.height());t=60;$(".game-on").hide();clearInterval(n)}},1e3)});h.on("the_word",function(e){o=e;$(".game-on").show()});h.on("user_connected",function(e){console.log(e+" connected");var t=$("<li/>",{text:"guest-"+e,id:"u"+e}).appendTo($(".users ul"));$("<span/>",{"class":"points",text:" - 0"}).appendTo(t);f=e});h.on("user_disconnected",function(e){console.log(e+" disconnected");$("li#u"+e).remove()});h.on("moving",function(e){e.id in l||(c[e.id]=$('<div class="cursor">').appendTo("#cursors"));c[e.id].css({left:e.x,top:e.y});e.drawing&&l[e.id]&&v(l[e.id].x,l[e.id].y,e.x,e.y);l[e.id]=e;l[e.id].updated=$.now()});var p={};r.on("mousedown",function(e){e.preventDefault();a=!0;p.x=e.pageX;p.y=e.pageY;s.fadeOut()});t.bind("mouseup mouseleave",function(){a=!1});var d=$.now();t.on("mousemove",function(e){if($.now()-d>30){h.emit("mousemove",{x:e.pageX,y:e.pageY,drawing:a,id:u});d=$.now()}if(a){v(p.x,p.y,e.pageX,e.pageY);p.x=e.pageX;p.y=e.pageY}});setInterval(function(){for(ident in l)if($.now()-l[ident].updated>3e5){c[ident].remove();delete l[ident];delete c[ident]}},3e5);$(".controls ul li").on("click",function(){var e=$(this);window.color=e.css("background-color")});$(".submit-guess").on("click",function(e){var t=$(".the-guess").val();t==o&&alert("yay u won!");e.preventDefault()})});